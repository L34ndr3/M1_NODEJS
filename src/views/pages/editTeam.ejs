<%- include('../partials/header') %>

    <div class="max-w-md mx-auto bg-slate-800 p-8 rounded-xl shadow-2xl border border-slate-700 mt-10">
        <h1 class="text-3xl font-bold mb-6 text-yellow-500">Modifier l'Équipe</h1>

        <form id="editTeamForm" class="space-y-6">
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Nom de l'équipe</label>
                <input type="text" name="name" value="<%= team.name %>" required
                    class="w-full bg-slate-900 border border-slate-600 rounded-lg p-3 text-white focus:border-yellow-500 outline-none">
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Tag</label>
                <input type="text" name="tag" value="<%= team.tag %>" required
                    class="w-full bg-slate-900 border border-slate-600 rounded-lg p-3 text-white focus:border-yellow-500 outline-none uppercase">
            </div>

            <div class="flex gap-4">
                <a href="/"
                    class="flex-1 bg-slate-700 text-center py-3 rounded-lg hover:bg-slate-600 text-white">Annuler</a>
                <button type="submit"
                    class="flex-1 bg-yellow-600 hover:bg-yellow-500 text-white font-bold py-3 rounded-lg shadow-lg">
                    Mettre à jour
                </button>
            </div>
        </form>

        <div id="msg" class="mt-4 text-center hidden"></div>
    </div>

    <script>
        const token = localStorage.getItem('token');

        document.getElementById('editTeamForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());

            const res = await fetch('/api/teams/<%= team.id %>', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                },
                body: JSON.stringify(data)
            });

            const result = await res.json();
            const msgDiv = document.getElementById('msg');
            msgDiv.classList.remove('hidden');

            if (result.success) {
                msgDiv.className = "mt-4 p-3 bg-green-900 text-green-200 rounded";
                msgDiv.innerText = "Mise à jour réussie !";
                setTimeout(() => window.location.href = '/', 1000);
            } else {
                msgDiv.className = "mt-4 p-3 bg-red-900 text-red-200 rounded";
                msgDiv.innerText = "Erreur: " + (result.message);
            }
        });
    </script>

    <%- include('../partials/footer') %>